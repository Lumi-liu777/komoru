{"ast":null,"code":"var _jsxFileName = \"/Users/ahsi.aki/Desktop/\\u5927\\u5C08/komoru/client/src/components/Login.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport \"./Login.css\";\nimport axios from \"axios\";\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Login(props) {\n  _s();\n\n  let navigate = useNavigate();\n  const [mail, setMail] = React.useState(\"\");\n  const [passwd, setPasswd] = React.useState(\"\");\n  const [mailOK, setMailOK] = React.useState(\"\"); //確認mail是否設定好在顯示密碼欄位\n\n  const [loginStatus, setLoginStatus] = React.useState(false); //設置jwt使用按鈕狀態\n\n  const inputEmailHandler = e => {\n    setMail(() => e.target.value);\n  };\n\n  console.log(mail); //動態追蹤輸入的mail值\n\n  const inputPasswdHandler = e => {\n    setPasswd(() => e.target.value);\n  };\n\n  console.log(passwd); //動態追蹤輸入的pw值\n\n  const loginHandler = () => {\n    if (mail !== \"\") {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:5000/member/emailIsExisted',\n        data: {\n          mail: mail\n        }\n      }).then(res => {\n        console.log(res.data); // 印出資料庫回傳的資料看看（若尚未註冊不會顯示）\n\n        if (res.data[0].memberMail === mail) {\n          setMailOK(prevMailOK => `親愛的${res.data[0].memberNickName}，歡迎您回來`); //輸入mail與資料庫資料吻合setOK\n        } else {// console.log(mail) //動態追蹤輸入的mail值\n          // alert(\"該mail尚未註冊，將為您跳轉至註冊頁\"); // 簡易版\n          // navigate('/register',{state: { userMail: mail } }, { replace: true })\n        }\n      }).catch(e => {\n        console.log(mail); //動態追蹤輸入的mail值\n\n        alert(\"該mail尚未註冊，將為您跳轉至註冊頁\");\n        navigate('/register', {\n          state: {\n            userMail: mail\n          }\n        }, {\n          replace: true\n        });\n      });\n    } else if (mail === \"\") {\n      alert(\"請輸入電子信箱\");\n    }\n  };\n\n  const userAuth = () => {\n    axios({\n      method: 'get',\n      url: \"http://localhost:5000/member/isUserAuth\",\n      headers: {\n        \"x-access-token\": localStorage.getItem(\"token\")\n      }\n    }).then(res => {\n      console.log(res);\n      alert('登入成功！');\n      navigate('/', {\n        replace: true\n      });\n    });\n  };\n\n  const loginHandler2 = () => {\n    if (mail !== \"\" && passwd !== \"\") {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:5000/member/loginAuth',\n        data: {\n          mail: mail,\n          passwd: passwd\n        }\n      }).then(res => {\n        console.log(res.data); // 印出撈到的資料看看\n\n        console.log(res.data.token); // 印出撈到的token看看\n\n        if (res.data.result[0].memberMail === mail && res.data.result[0].memberPasswd === passwd) {\n          localStorage.setItem(\"token\", res.data.token);\n          setLoginStatus(true); // 插入驗證事情\n          // alert(\"登入成功！\");\n          // navigate('/', { replace: true })\n          // 後端必須另外設定jwtcookie\n        } else {\n          console.log(mail, passwd); //動態追蹤輸入的mail值\n\n          alert(\"帳號或密碼錯誤\"); // 簡易版\n        }\n      }).catch(e => {\n        // if (e.response.error) {\n        alert(\"帳號或密碼錯誤\"); // 進階版\n        // }\n      });\n    } else if (mail === \"\" || passwd === \"\") {\n      alert(\"請填寫帳號及密碼\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"login--title\",\n      children: \"\\u767B\\u5165\\u6216\\u5EFA\\u7ACB\\u5E33\\u6236\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n      children: mailOK\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      className: \"login--input--L\",\n      name: \"mail\",\n      id: \"mail\",\n      type: \"email\",\n      onChange: inputEmailHandler\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this), mailOK && /*#__PURE__*/_jsxDEV(\"input\", {\n      placeholder: \"\\u8ACB\\u586B\\u5BEB\\u5BC6\\u78BC\",\n      className: \"login--input--L\",\n      name: \"passwd\",\n      id: \"passwd\",\n      type: \"password\",\n      onChange: inputPasswdHandler\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 19\n    }, this), !loginStatus && /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"login--submit\",\n      onClick: mailOK ? loginHandler2 : loginHandler,\n      children: \"\\u4F7F\\u7528\\u96FB\\u5B50\\u4FE1\\u7BB1\\u7E7C\\u7E8C\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 25\n    }, this), loginStatus && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: userAuth,\n      className: \"login--submit text-wine\",\n      children: \"\\u9EDE\\u64CA\\u5F8C\\u9032\\u884C\\u4E8C\\u6B21\\u8A8D\\u8B49\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 24\n    }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n      href: \"/ForgotPW\",\n      className: \"login--forgot\",\n      children: \"\\u5FD8\\u8A18\\u5BC6\\u78BC\\uFF1F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"login--subTitle\",\n      children: \"\\u6216\\u4F7F\\u7528\\u4EE5\\u4E0B\\u9078\\u9805\\u767B\\u5165\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"login--other\",\n      children: [/*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"login--block\",\n        children: \"Google\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"login--block\",\n        children: \"Facebook\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"login--block\",\n        children: \"LINE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Login, \"SOSus1iOiOuKUldj9e/1r8uRgws=\", false, function () {\n  return [useNavigate];\n});\n\n_c = Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","axios","useNavigate","Login","props","navigate","mail","setMail","useState","passwd","setPasswd","mailOK","setMailOK","loginStatus","setLoginStatus","inputEmailHandler","e","target","value","console","log","inputPasswdHandler","loginHandler","method","url","data","then","res","memberMail","prevMailOK","memberNickName","catch","alert","state","userMail","replace","userAuth","headers","localStorage","getItem","loginHandler2","token","result","memberPasswd","setItem"],"sources":["/Users/ahsi.aki/Desktop/大專/komoru/client/src/components/Login.js"],"sourcesContent":["import React from \"react\"\nimport \"./Login.css\"\nimport axios from \"axios\"\nimport { useNavigate } from 'react-router-dom'\n\n\nexport default function Login(props) {\n\n  let navigate = useNavigate()\n\n  const [mail, setMail] = React.useState(\"\");\n  const [passwd, setPasswd] = React.useState(\"\");\n  const [mailOK,setMailOK] = React.useState(\"\"); //確認mail是否設定好在顯示密碼欄位\n  const [loginStatus,setLoginStatus] = React.useState(false); //設置jwt使用按鈕狀態\n\n  const inputEmailHandler = (e) => {\n    setMail(() => (e.target.value));\n  }\n  console.log(mail) //動態追蹤輸入的mail值\n\n  const inputPasswdHandler = (e) => {\n    setPasswd(() => (e.target.value))\n  }\n  console.log(passwd) //動態追蹤輸入的pw值\n\n\n\n\n  const loginHandler = () => {\n    if (mail !== \"\") {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:5000/member/emailIsExisted',\n        data: {\n          mail: mail,\n        }\n      })\n        .then((res) => {\n          console.log(res.data)// 印出資料庫回傳的資料看看（若尚未註冊不會顯示）\n          if (res.data[0].memberMail === mail) {\n            setMailOK(prevMailOK => `親愛的${res.data[0].memberNickName}，歡迎您回來` ) //輸入mail與資料庫資料吻合setOK\n          } else {\n            // console.log(mail) //動態追蹤輸入的mail值\n            // alert(\"該mail尚未註冊，將為您跳轉至註冊頁\"); // 簡易版\n            // navigate('/register',{state: { userMail: mail } }, { replace: true })\n          }\n        })\n        .catch((e) => {\n          console.log(mail) //動態追蹤輸入的mail值\n          alert(\"該mail尚未註冊，將為您跳轉至註冊頁\"); \n          navigate('/register',{state: { userMail: mail } }, { replace: true })\n        });\n    } else if (mail === \"\") {\n      alert(\"請輸入電子信箱\");\n    }\n  }\n\n  const userAuth = () => {\n    axios({\n      method:'get',\n      url:\"http://localhost:5000/member/isUserAuth\",\n      headers: {\"x-access-token\": localStorage.getItem(\"token\")}\n      \n    }).then((res) => {\n      console.log(res)\n      alert('登入成功！')\n      navigate('/', { replace: true })\n\n    })\n  }\n\n  const loginHandler2 = () => {\n    if (mail !== \"\" && passwd !== \"\") {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:5000/member/loginAuth',\n        data: {\n          mail: mail,\n          passwd:passwd\n        }\n      })\n        .then((res) => {\n          console.log(res.data)// 印出撈到的資料看看\n          console.log(res.data.token)// 印出撈到的token看看\n\n\n          if (res.data.result[0].memberMail === mail && res.data.result[0].memberPasswd === passwd) {\n            localStorage.setItem(\"token\",res.data.token)\n            setLoginStatus(true) // 插入驗證事情\n            // alert(\"登入成功！\");\n            // navigate('/', { replace: true })\n            // 後端必須另外設定jwtcookie\n          } else {\n            console.log(mail,passwd) //動態追蹤輸入的mail值\n            alert(\"帳號或密碼錯誤\"); // 簡易版\n          }\n        })\n        .catch((e) => {\n          // if (e.response.error) {\n            alert(\"帳號或密碼錯誤\"); // 進階版\n          // }\n        });\n    } else if (mail === \"\" || passwd=== \"\") {\n      alert(\"請填寫帳號及密碼\");\n    }\n  }\n\n  return (\n\n\n    <div className=\"login\">\n      <h2 className=\"login--title\">登入或建立帳戶</h2>\n      <h5>{mailOK}</h5>\n      <input className=\"login--input--L\" name=\"mail\" id=\"mail\" type=\"email\" onChange={inputEmailHandler} />\n      \n      { mailOK && <input placeholder=\"請填寫密碼\" \n        className=\"login--input--L\" name=\"passwd\" id=\"passwd\" \n        type=\"password\" onChange={inputPasswdHandler} /> }\n      \n      { !loginStatus && <button className=\"login--submit\" \n        onClick={mailOK ? loginHandler2:loginHandler}>使用電子信箱繼續</button> }\n\n      { loginStatus && <button onClick={userAuth} className=\"login--submit text-wine\">點擊後進行二次認證</button> }\n\n      \n\n      <a href=\"/ForgotPW\" className=\"login--forgot\">忘記密碼？</a>\n\n      <h3 className=\"login--subTitle\">或使用以下選項登入</h3>\n      <ul className=\"login--other\">\n        <li className=\"login--block\">Google</li>\n        <li className=\"login--block\">Facebook</li>\n        <li className=\"login--block\">LINE</li>\n      </ul>\n\n    </div>\n\n\n\n\n  )\n\n}\n"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,aAAP;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,QAA4B,kBAA5B;;AAGA,eAAe,SAASC,KAAT,CAAeC,KAAf,EAAsB;EAAA;;EAEnC,IAAIC,QAAQ,GAAGH,WAAW,EAA1B;EAEA,MAAM,CAACI,IAAD,EAAOC,OAAP,IAAkBP,KAAK,CAACQ,QAAN,CAAe,EAAf,CAAxB;EACA,MAAM,CAACC,MAAD,EAASC,SAAT,IAAsBV,KAAK,CAACQ,QAAN,CAAe,EAAf,CAA5B;EACA,MAAM,CAACG,MAAD,EAAQC,SAAR,IAAqBZ,KAAK,CAACQ,QAAN,CAAe,EAAf,CAA3B,CANmC,CAMY;;EAC/C,MAAM,CAACK,WAAD,EAAaC,cAAb,IAA+Bd,KAAK,CAACQ,QAAN,CAAe,KAAf,CAArC,CAPmC,CAOyB;;EAE5D,MAAMO,iBAAiB,GAAIC,CAAD,IAAO;IAC/BT,OAAO,CAAC,MAAOS,CAAC,CAACC,MAAF,CAASC,KAAjB,CAAP;EACD,CAFD;;EAGAC,OAAO,CAACC,GAAR,CAAYd,IAAZ,EAZmC,CAYjB;;EAElB,MAAMe,kBAAkB,GAAIL,CAAD,IAAO;IAChCN,SAAS,CAAC,MAAOM,CAAC,CAACC,MAAF,CAASC,KAAjB,CAAT;EACD,CAFD;;EAGAC,OAAO,CAACC,GAAR,CAAYX,MAAZ,EAjBmC,CAiBf;;EAKpB,MAAMa,YAAY,GAAG,MAAM;IACzB,IAAIhB,IAAI,KAAK,EAAb,EAAiB;MACfL,KAAK,CAAC;QACJsB,MAAM,EAAE,MADJ;QAEJC,GAAG,EAAE,6CAFD;QAGJC,IAAI,EAAE;UACJnB,IAAI,EAAEA;QADF;MAHF,CAAD,CAAL,CAOGoB,IAPH,CAOSC,GAAD,IAAS;QACbR,OAAO,CAACC,GAAR,CAAYO,GAAG,CAACF,IAAhB,EADa,CACQ;;QACrB,IAAIE,GAAG,CAACF,IAAJ,CAAS,CAAT,EAAYG,UAAZ,KAA2BtB,IAA/B,EAAqC;UACnCM,SAAS,CAACiB,UAAU,IAAK,MAAKF,GAAG,CAACF,IAAJ,CAAS,CAAT,EAAYK,cAAe,QAAhD,CAAT,CADmC,CACgC;QACpE,CAFD,MAEO,CACL;UACA;UACA;QACD;MACF,CAhBH,EAiBGC,KAjBH,CAiBUf,CAAD,IAAO;QACZG,OAAO,CAACC,GAAR,CAAYd,IAAZ,EADY,CACM;;QAClB0B,KAAK,CAAC,qBAAD,CAAL;QACA3B,QAAQ,CAAC,WAAD,EAAa;UAAC4B,KAAK,EAAE;YAAEC,QAAQ,EAAE5B;UAAZ;QAAR,CAAb,EAA2C;UAAE6B,OAAO,EAAE;QAAX,CAA3C,CAAR;MACD,CArBH;IAsBD,CAvBD,MAuBO,IAAI7B,IAAI,KAAK,EAAb,EAAiB;MACtB0B,KAAK,CAAC,SAAD,CAAL;IACD;EACF,CA3BD;;EA6BA,MAAMI,QAAQ,GAAG,MAAM;IACrBnC,KAAK,CAAC;MACJsB,MAAM,EAAC,KADH;MAEJC,GAAG,EAAC,yCAFA;MAGJa,OAAO,EAAE;QAAC,kBAAkBC,YAAY,CAACC,OAAb,CAAqB,OAArB;MAAnB;IAHL,CAAD,CAAL,CAKGb,IALH,CAKSC,GAAD,IAAS;MACfR,OAAO,CAACC,GAAR,CAAYO,GAAZ;MACAK,KAAK,CAAC,OAAD,CAAL;MACA3B,QAAQ,CAAC,GAAD,EAAM;QAAE8B,OAAO,EAAE;MAAX,CAAN,CAAR;IAED,CAVD;EAWD,CAZD;;EAcA,MAAMK,aAAa,GAAG,MAAM;IAC1B,IAAIlC,IAAI,KAAK,EAAT,IAAeG,MAAM,KAAK,EAA9B,EAAkC;MAChCR,KAAK,CAAC;QACJsB,MAAM,EAAE,MADJ;QAEJC,GAAG,EAAE,wCAFD;QAGJC,IAAI,EAAE;UACJnB,IAAI,EAAEA,IADF;UAEJG,MAAM,EAACA;QAFH;MAHF,CAAD,CAAL,CAQGiB,IARH,CAQSC,GAAD,IAAS;QACbR,OAAO,CAACC,GAAR,CAAYO,GAAG,CAACF,IAAhB,EADa,CACQ;;QACrBN,OAAO,CAACC,GAAR,CAAYO,GAAG,CAACF,IAAJ,CAASgB,KAArB,EAFa,CAEc;;QAG3B,IAAId,GAAG,CAACF,IAAJ,CAASiB,MAAT,CAAgB,CAAhB,EAAmBd,UAAnB,KAAkCtB,IAAlC,IAA0CqB,GAAG,CAACF,IAAJ,CAASiB,MAAT,CAAgB,CAAhB,EAAmBC,YAAnB,KAAoClC,MAAlF,EAA0F;UACxF6B,YAAY,CAACM,OAAb,CAAqB,OAArB,EAA6BjB,GAAG,CAACF,IAAJ,CAASgB,KAAtC;UACA3B,cAAc,CAAC,IAAD,CAAd,CAFwF,CAEnE;UACrB;UACA;UACA;QACD,CAND,MAMO;UACLK,OAAO,CAACC,GAAR,CAAYd,IAAZ,EAAiBG,MAAjB,EADK,CACoB;;UACzBuB,KAAK,CAAC,SAAD,CAAL,CAFK,CAEa;QACnB;MACF,CAvBH,EAwBGD,KAxBH,CAwBUf,CAAD,IAAO;QACZ;QACEgB,KAAK,CAAC,SAAD,CAAL,CAFU,CAEQ;QACpB;MACD,CA5BH;IA6BD,CA9BD,MA8BO,IAAI1B,IAAI,KAAK,EAAT,IAAeG,MAAM,KAAI,EAA7B,EAAiC;MACtCuB,KAAK,CAAC,UAAD,CAAL;IACD;EACF,CAlCD;;EAoCA,oBAGE;IAAK,SAAS,EAAC,OAAf;IAAA,wBACE;MAAI,SAAS,EAAC,cAAd;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QADF,eAEE;MAAA,UAAKrB;IAAL;MAAA;MAAA;MAAA;IAAA,QAFF,eAGE;MAAO,SAAS,EAAC,iBAAjB;MAAmC,IAAI,EAAC,MAAxC;MAA+C,EAAE,EAAC,MAAlD;MAAyD,IAAI,EAAC,OAA9D;MAAsE,QAAQ,EAAEI;IAAhF;MAAA;MAAA;MAAA;IAAA,QAHF,EAKIJ,MAAM,iBAAI;MAAO,WAAW,EAAC,gCAAnB;MACV,SAAS,EAAC,iBADA;MACkB,IAAI,EAAC,QADvB;MACgC,EAAE,EAAC,QADnC;MAEV,IAAI,EAAC,UAFK;MAEM,QAAQ,EAAEU;IAFhB;MAAA;MAAA;MAAA;IAAA,QALd,EASI,CAACR,WAAD,iBAAgB;MAAQ,SAAS,EAAC,eAAlB;MAChB,OAAO,EAAEF,MAAM,GAAG6B,aAAH,GAAiBlB,YADhB;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QATpB,EAYIT,WAAW,iBAAI;MAAQ,OAAO,EAAEuB,QAAjB;MAA2B,SAAS,EAAC,yBAArC;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAZnB,eAgBE;MAAG,IAAI,EAAC,WAAR;MAAoB,SAAS,EAAC,eAA9B;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAhBF,eAkBE;MAAI,SAAS,EAAC,iBAAd;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAlBF,eAmBE;MAAI,SAAS,EAAC,cAAd;MAAA,wBACE;QAAI,SAAS,EAAC,cAAd;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QADF,eAEE;QAAI,SAAS,EAAC,cAAd;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAFF,eAGE;QAAI,SAAS,EAAC,cAAd;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAHF;IAAA;MAAA;MAAA;MAAA;IAAA,QAnBF;EAAA;IAAA;IAAA;IAAA;EAAA,QAHF;AAmCD;;GAxIuBjC,K;UAEPD,W;;;KAFOC,K"},"metadata":{},"sourceType":"module"}