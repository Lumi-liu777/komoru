{"ast":null,"code":"var _jsxFileName = \"/Users/ahsi.aki/Desktop/komoru/client/src/components/Login/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport \"./Login.css\";\nimport axios from \"axios\";\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Login(props) {\n  _s();\n\n  let navigate = useNavigate();\n  const [mail, setMail] = useState(\"\");\n  const [passwd, setPasswd] = useState(\"\");\n  const [mailCheck, setMailCheck] = useState(\"\"); //確認mail是否設定好在顯示密碼欄位\n\n  const [loginStatus, setLoginStatus] = useState(false); //設置jwt使用按鈕狀態\n\n  const inputEmailHandler = e => {\n    setMail(() => e.target.value);\n  }; //console.log(mail) //動態追蹤輸入的mail值\n\n\n  const inputPasswdHandler = e => {\n    setPasswd(() => e.target.value);\n  }; //console.log(passwd) //動態追蹤輸入的pw值\n  // 0620 aki - 驗證網站是否有該會員：有的人才能輸入密碼＆向他打招呼\n  // 若該mail網站沒有，將會導向註冊頁面\n\n\n  const loginHandler = () => {\n    if (mail !== \"\") {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:5000/member/checkMailIsExisted',\n        data: {\n          mail: mail\n        }\n      }).then(res => {\n        console.log(res.data); // 印出資料庫回傳的資料看看（若尚未註冊不會顯示）\n\n        if (res.data[0].memberMail === mail) {\n          setMailCheck(prevMailCheck => `親愛的${res.data[0].memberNickName}，歡迎您回來`); //輸入mail與資料庫資料吻合setOK\n        }\n      }).catch(e => {\n        console.log(mail); //動態追蹤輸入的mail值\n\n        alert(\"該mail尚未註冊，將為您跳轉至註冊頁\");\n        navigate('/register', {\n          state: {\n            userMail: mail\n          }\n        }, {\n          replace: true\n        });\n      });\n    } else if (mail === \"\") {\n      alert(\"請輸入電子信箱\");\n    }\n  }; // 0620 aki - 正式驗證帳號及密碼：登入驗證\n\n\n  const loginHandlerWithPW = () => {\n    if (mail !== \"\" && passwd !== \"\") {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:5000/member/loginAuth',\n        data: {\n          mail: mail,\n          passwd: passwd\n        }\n      }).then(res => {\n        console.log(res.data); // 印出撈到的資料看看\n\n        console.log(res.data.token); // 印出撈到的token看看\n\n        if (res.data.result[0].memberMail === mail && res.data.result[0].memberPasswd === passwd) {\n          localStorage.setItem(\"token\", res.data.token); // setUserIsLogin({isLoginMail:mail, isLoginToken:res.data.token})\n\n          setLoginStatus(true); // 插入驗證事情\n        } else {\n          console.log(mail, passwd); //動態追蹤輸入的mail值\n\n          alert(\"帳號或密碼錯誤\"); // 簡易版\n        }\n      }).catch(e => {\n        // if (e.response.error) {\n        alert(\"帳號或密碼錯誤\"); // 進階版\n        // }\n      });\n    } else if (mail === \"\" || passwd === \"\") {\n      alert(\"請填寫帳號及密碼\");\n    }\n  }; // 0620 aki - 二次驗證：帳密都驗證好才會觸發，發放token\n  // 完成後導向首頁\n\n\n  const userAuth = () => {\n    axios({\n      method: 'get',\n      url: \"http://localhost:5000/member/verifyJWT\",\n      headers: {\n        \"x-access-token\": localStorage.getItem(\"token\")\n      }\n    }).then(res => {\n      console.log(res);\n      alert('登入成功！');\n      navigate('/', {\n        replace: true\n      });\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"login--title\",\n      children: \"\\u767B\\u5165\\u6216\\u5EFA\\u7ACB\\u5E33\\u6236\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n      children: mailCheck\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      className: \"login--input--L\",\n      name: \"mail\",\n      id: \"mail\",\n      type: \"email\",\n      onChange: inputEmailHandler\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this), mailCheck && /*#__PURE__*/_jsxDEV(\"input\", {\n      placeholder: \"\\u8ACB\\u586B\\u5BEB\\u5BC6\\u78BC\",\n      className: \"login--input--L\",\n      name: \"passwd\",\n      id: \"passwd\",\n      type: \"password\",\n      onChange: inputPasswdHandler\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 21\n    }, this), !loginStatus && /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"login--submit\",\n      onClick: mailCheck ? loginHandlerWithPW : loginHandler,\n      children: \"\\u4F7F\\u7528\\u96FB\\u5B50\\u4FE1\\u7BB1\\u7E7C\\u7E8C\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 24\n    }, this), loginStatus && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: userAuth,\n      className: \"login--submit text-wine\",\n      children: \"\\u9EDE\\u64CA\\u5F8C\\u9032\\u884C\\u4E8C\\u6B21\\u8A8D\\u8B49\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 23\n    }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n      href: \"/ForgotPW\",\n      className: \"login--forgot\",\n      children: \"\\u5FD8\\u8A18\\u5BC6\\u78BC\\uFF1F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"login--subTitle\",\n      children: \"\\u6216\\u4F7F\\u7528\\u4EE5\\u4E0B\\u9078\\u9805\\u767B\\u5165\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"login--other\",\n      children: [/*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"login--block\",\n        children: \"Google\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"login--block\",\n        children: \"Facebook\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"login--block\",\n        children: \"LINE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Login, \"8981WDmjr52G+0wAxWJjpscsFuA=\", false, function () {\n  return [useNavigate];\n});\n\n_c = Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useState","axios","useNavigate","Login","props","navigate","mail","setMail","passwd","setPasswd","mailCheck","setMailCheck","loginStatus","setLoginStatus","inputEmailHandler","e","target","value","inputPasswdHandler","loginHandler","method","url","data","then","res","console","log","memberMail","prevMailCheck","memberNickName","catch","alert","state","userMail","replace","loginHandlerWithPW","token","result","memberPasswd","localStorage","setItem","userAuth","headers","getItem"],"sources":["/Users/ahsi.aki/Desktop/komoru/client/src/components/Login/Login.js"],"sourcesContent":["import React, { useState } from \"react\"\nimport \"./Login.css\"\nimport axios from \"axios\"\nimport { useNavigate } from 'react-router-dom'\n\n\nexport default function Login(props) {\n\n  let navigate = useNavigate()\n\n  const [mail, setMail] = useState(\"\");\n  const [passwd, setPasswd] = useState(\"\");\n  const [mailCheck, setMailCheck] = useState(\"\"); //確認mail是否設定好在顯示密碼欄位\n  const [loginStatus, setLoginStatus] = useState(false); //設置jwt使用按鈕狀態\n\n  const inputEmailHandler = (e) => {\n    setMail(() => (e.target.value));\n  }\n  //console.log(mail) //動態追蹤輸入的mail值\n\n  const inputPasswdHandler = (e) => {\n    setPasswd(() => (e.target.value))\n  }\n  //console.log(passwd) //動態追蹤輸入的pw值\n\n\n\n  // 0620 aki - 驗證網站是否有該會員：有的人才能輸入密碼＆向他打招呼\n  // 若該mail網站沒有，將會導向註冊頁面\n  const loginHandler = () => {\n    if (mail !== \"\") {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:5000/member/checkMailIsExisted',\n        data: {\n          mail: mail,\n        }\n      })\n        .then((res) => {\n          console.log(res.data)// 印出資料庫回傳的資料看看（若尚未註冊不會顯示）\n          if (res.data[0].memberMail === mail) {\n            setMailCheck(prevMailCheck => `親愛的${res.data[0].memberNickName}，歡迎您回來`) //輸入mail與資料庫資料吻合setOK\n          } \n        })\n        .catch((e) => {\n          console.log(mail) //動態追蹤輸入的mail值\n          alert(\"該mail尚未註冊，將為您跳轉至註冊頁\");\n          navigate('/register', { state: { userMail: mail } }, { replace: true })\n        });\n    } else if (mail === \"\") {\n      alert(\"請輸入電子信箱\");\n    }\n  }\n\n\n  // 0620 aki - 正式驗證帳號及密碼：登入驗證\n  const loginHandlerWithPW = () => {\n    if (mail !== \"\" && passwd !== \"\") {\n      axios({\n        method: 'POST',\n        url: 'http://localhost:5000/member/loginAuth',\n        data: {\n          mail: mail,\n          passwd: passwd\n        }\n      })\n        .then((res) => {\n          console.log(res.data)// 印出撈到的資料看看\n          console.log(res.data.token)// 印出撈到的token看看\n\n          if (res.data.result[0].memberMail === mail && res.data.result[0].memberPasswd === passwd) {\n            localStorage.setItem(\"token\", res.data.token)\n            // setUserIsLogin({isLoginMail:mail, isLoginToken:res.data.token})\n            setLoginStatus(true) // 插入驗證事情\n\n          } else {\n            console.log(mail, passwd) //動態追蹤輸入的mail值\n            alert(\"帳號或密碼錯誤\"); // 簡易版\n          }\n        })\n        .catch((e) => {\n          // if (e.response.error) {\n          alert(\"帳號或密碼錯誤\"); // 進階版\n          // }\n        });\n    } else if (mail === \"\" || passwd === \"\") {\n      alert(\"請填寫帳號及密碼\");\n    }\n  }\n\n  // 0620 aki - 二次驗證：帳密都驗證好才會觸發，發放token\n  // 完成後導向首頁\n  const userAuth = () => {\n    axios({\n      method: 'get',\n      url: \"http://localhost:5000/member/verifyJWT\",\n      headers: { \"x-access-token\": localStorage.getItem(\"token\") }\n\n    }).then((res) => {\n      console.log(res)\n\n      alert('登入成功！')\n      navigate('/', { replace: true })\n  \n    })\n  }\n\n\n\n\n\n\n\n\n  return (\n    <div className=\"login\">\n      <h2 className=\"login--title\">登入或建立帳戶</h2>\n      <h5>{mailCheck}</h5>\n      <input className=\"login--input--L\" name=\"mail\" id=\"mail\" type=\"email\" onChange={inputEmailHandler} />\n\n      {mailCheck && <input placeholder=\"請填寫密碼\"\n        className=\"login--input--L\" name=\"passwd\" id=\"passwd\"\n        type=\"password\" onChange={inputPasswdHandler} />}\n\n      {!loginStatus && <button className=\"login--submit\"\n        onClick={mailCheck ? loginHandlerWithPW : loginHandler}>使用電子信箱繼續</button>}\n\n      {loginStatus && <button onClick={userAuth} className=\"login--submit text-wine\">點擊後進行二次認證</button>}\n\n\n\n      <a href=\"/ForgotPW\" className=\"login--forgot\">忘記密碼？</a>\n\n      <h3 className=\"login--subTitle\">或使用以下選項登入</h3>\n      <ul className=\"login--other\">\n        <li className=\"login--block\">Google</li>\n        <li className=\"login--block\">Facebook</li>\n        <li className=\"login--block\">LINE</li>\n      </ul>\n\n    </div>\n\n\n\n\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}